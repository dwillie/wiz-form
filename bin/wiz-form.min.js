angular.module("asset.common.partials.wiz",[]).directive("wizForm",function(){return{restrict:"E",templateUrl:"common/partials/templates/wiz-form.tpl.html",transclude:!0,replace:!0,scope:{onFinish:"&",wizardMeta:"="},controller:["$scope",function(a){return a.steps=[],a.currentStep=0,this.registerStep=function(b){return a.steps.push(b),a.wizardMeta&&(a.wizardMeta.totalSteps=a.steps.length),a.steps.length-1},this.getCurrentStep=function(){return a.currentStep},a.nextText=function(){return a.steps[a.currentStep]&&a.steps[a.currentStep].next_text?a.steps[a.currentStep].next_text:!1},a.previousText=function(){return a.steps[a.currentStep]&&a.steps[a.currentStep].previous_text?a.steps[a.currentStep].previous_text:!1},a.isError=function(){return null!=a.message&&null!=a.message.error},a.previousStep=function(){return a.currentStep>0?a.currentStep-=1:void 0},a.lastStep=function(){return a.currentStep>=a.steps.length-1},a.nextStep=function(){var b;return b=a.steps[a.currentStep].ready_check,null!=b&&(a.message=b()),a.isError()?void 0:(a.message=null,a.lastStep()?a.onFinish?a.onFinish():void 0:a.currentStep+=1)},a.$watch("currentStep",function(){return a.wizardMeta&&a.steps[a.currentStep]&&a.steps[a.currentStep].name?(a.wizardMeta.activeStep=a.currentStep,a.wizardMeta.activeStepName=a.steps[a.currentStep].name):void 0}),this}]}}).directive("wizStep",function(){return{restrict:"E",templateUrl:"common/partials/templates/wiz-step.tpl.html",transclude:!0,replace:!0,require:"^wizForm",scope:{readyCheck:"&",nextText:"@",previousText:"@"},link:function(a,b,c,d){var e;return c.readyCheck||(a.readyCheck=null),e=d.registerStep({name:c.name,element:b,ready_check:a.readyCheck,next_text:a.nextText,previous_text:a.previousText}),a.wizFormCtrl=d,a.$watch("wizFormCtrl.getCurrentStep()",function(){return d.getCurrentStep()===e?b.show():b.hide()})}}});